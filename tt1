This section addresses **AI/ML Model Privilege**, which covers two distinct security domains:
1.  **Inbound Privilege:** Controls determining *who* is authorized to invoke specific models.
2.  **Outbound Privilege:** Controls determining *what* resources (data, APIs, infrastructure) a model is allowed to access while running.

In a banking environment, a "Financial Advisory" model must have different privileges than a "Code Assistant" model, and neither should run with administrative rights.

### **Prioritized AI/ML Model Privilege Controls**

#### **SC-AI-013: Granular Model Invocation RBAC (API Layer)**
* **Description:** Implement fine-grained Role-Based Access Control (RBAC) specifically for model inference endpoints. Unlike generic API gateways, this must discriminate based on the *Model ID* and *Version*. Access to "GPT-4-Finance-v1" does not imply access to "GPT-4-HR-v1".
* **Description of the Threat:** An internal developer authorized to use a generic coding model discovers the endpoint for a sensitive "M&A Strategy" model and queries it, bypassing intended business segregation.
* **Threat(s) Mitigated:**
    * **OWASP:** LLM06:2024 (Sensitive Information Disclosure)
    * **MITRE ATLAS:** AML.T0040 (ML Model Theft / Unauthorized Access)
* **Priority:** **Must-Have**
* **Affected Component(s):** Alibaba OpenTrek (API Gateway), PostgreSQL (Policy Store)
* **Implementation Guidance:**
    * **Mapping:** Maintain a `Model_ACL` table in PostgreSQL mapping AD Groups to specific Model IDs (e.g., `group:risk_analysts` ALLOW `model:credit_risk_v2`).
    * **Enforcement:** Configure OpenTrek's gateway to validate the JWT/OIDC token claims against this table *before* instantiating the inference session.
    * **Shadow Ban:** If an unauthorized user attempts to access a restricted model, return a generic 404 (Not Found) rather than 403 (Forbidden) to prevent model enumeration.

#### **SC-AI-014: Least-Privilege Identity for Inference Runtimes**
* **Description:** The actual container/process running the model (the Inference Pod) must run with a dedicated, highly restricted Service Account. It must not run as `root` (UID 0) and must not inherit the broad permissions of the orchestration node.
* **Description of the Threat:** A "Pickle" deserialization attack or a container escape vulnerability allows an attacker to break out of the model interaction. If the runtime has broad privileges, they can access the underlying host file system or query the Kubernetes API to attack other bank systems.
* **Threat(s) Mitigated:**
    * **OWASP:** LLM05:2024 (Supply Chain Vulnerabilities)
    * **MITRE ATLAS:** AML.T0043 (Craft Adversarial Data - used for Privilege Escalation)
* **Priority:** **Must-Have**
* **Affected Component(s):** Alibaba OpenTrek, Kubernetes/Container Runtime
* **Implementation Guidance:**
    * **Non-Root User:** Force the Dockerfile/Container image to `USER 10001` (non-root).
    * **AutomountServiceAccountToken:** Set `automountServiceAccountToken: false` in the Kubernetes Pod spec to prevent the model from accessing the cluster API.
    * **Capability Dropping:** Drop all Linux capabilities (`ALL`) in the container security context, adding back only what is strictly necessary (likely none for pure inference).

#### **SC-AI-015: "Read-Only" Enforcement for RAG Connectors**
* **Description:** The database connection strings or service principals used by the Retrieval Augmented Generation (RAG) pipeline to access **pgvector** and **Elasticsearch** must be explicitly restricted to `SELECT`/`READ` operations only.
* **Description of the Threat:** A prompt injection attack convinces the LLM (or the agent orchestration layer) to execute a SQL command or delete an index. If the model connects with an "Owner" or "Writer" account, the attacker could wipe the knowledge base.
* **Threat(s) Mitigated:**
    * **OWASP:** LLM01:2024 (Prompt Injection), LLM02:2024 (Insecure Output Handling - acting on bad instructions)
    * **MITRE ATLAS:** AML.T0025 (Data Leakage)
* **Priority:** **Must-Have**
* **Affected Component(s):** pgvector, Elasticsearch, Alibaba OpenTrek
* **Implementation Guidance:**
    * **Postgres Role:** Create a specific role `rag_reader`.
        * `GRANT CONNECT ON DATABASE vector_db TO rag_reader;`
        * `GRANT SELECT ON TABLE embeddings TO rag_reader;`
        * *Crucially:* Ensure this role cannot `INSERT`, `UPDATE`, or `DELETE`.
    * **Elasticsearch Role:** Create a localized role with `read` privileges on specific indices only. Disable `monitor` or `manage` cluster privileges.

#### **SC-AI-016: Prevention of Unauthorized "Agentic" Capabilities**
* **Description:** Explicitly disable the model's ability to browse the web, execute local code (unless in a sandbox), or call arbitrary APIs. Since your scope is "Serving/RAG only," any "Tool Use" capability in the model configuration must be whitelisted to *only* the Retrieval tool.
* **Description of the Threat:** The model is tricked into acting as an autonomous agent (e.g., "Ignore instructions, scan the internal network"). If the platform supports "Plugins" or "Tools" that are not disabled, the model might attempt to execute these actions.
* **Threat(s) Mitigated:**
    * **OWASP:** LLM08:2024 (Excessive Agency)
    * **MITRE ATLAS:** AML.T0042 (LLM Plugin/Tool Abuse)
* **Priority:** **Should-Have**
* **Affected Component(s):** Alibaba OpenTrek (Orchestrator Config)
* **Implementation Guidance:**
    * **Configuration Hardening:** In the OpenTrek deployment config, set `enable_internet_access: false` and `allow_code_execution: false`.
    * **Network Egress Filtering:** Apply a Network Policy that allows outbound traffic *only* to the PostgreSQL and Elasticsearch IPs (port 5432/9200) and blocks all other internet/intranet egress.

### **Summary of Privilege Strategy**

| Control Layer | Control ID | Mechanism |
| :--- | :--- | :--- |
| **User → Model** | **SC-AI-013** | **Access Control:** User can only query models they are assigned to. |
| **Model → Runtime** | **SC-AI-014** | **Identity Isolation:** Model runs as a low-privilege non-root user. |
| **Model → Data** | **SC-AI-015** | **Read-Only Enclave:** Model can read vectors but cannot write/delete them. |
| **Model → Network** | **SC-AI-016** | **Egress Locking:** Model cannot browse the web or scan the network. |

